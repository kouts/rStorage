(function(a){function d(i){if(Object(i)!==i||Array.isArray(i)||Object.getOwnPropertyNames(i).length===0){return i}var f={},k,l,e,h,g;for(var j in i){k=f,l="",h=0;do{e=j.indexOf(".",h);g=j.substring(h,e!==-1?e:undefined);k=k[l]||(k[l]=(!isNaN(parseInt(g))?[]:{}));l=g;h=e+1}while(e>=0);k[l]=i[j]}return f[""]}function c(g){var e={};function f(n,o){if(Object(n)!==n){e[o]=n}else{if(Array.isArray(n)){for(var j=0,h=n.length;j<h;j++){f(n[j],o?o+"."+j:""+j)}if(h==0){e[o]=[]}}else{var m=true;for(var k in n){m=false;f(n[k],o?o+"."+k:k)}if(m){e[o]={}}}}}f(g,"");return e}function b(e){return{_merge:function(g,f){if(typeof(g)!="object"){return f}a.each(f,function(h){g[h]=f[h]});return g},_getNamespace:function(f){if(f.search(/\./)==-1){return f}return f.substr(0,f.indexOf("."))},_getKey:function(f){if(f.search(/\./)==-1){return null}return f.substr(f.indexOf(".")+1)},get:function(l){var i=this._getNamespace(l);l=this._getKey(l);if(!l){return JSON.parse(e.getItem(i))}else{var h=e.getItem(i);if(h){h=c(JSON.parse(h));if(h[l]===undefined){var g={},f;a.each(h,function(j,k){if(j.indexOf(".")!=-1&&j.search(l)!=-1){f=j.replace(l+".","");g[f]=k}});h=f?g:null}else{h=h[l]}return d(h)}else{return null}}},_save:function(m,h){var i=this._getNamespace(m);m=this._getKey(m);var g=e.getItem(i);if(g){g=c(JSON.parse(g));var l=g;var k=false;a.each(g,function(j){if(j==m){l[m]=h;k=true}});if(!k){if(m){var f={};f[m]=h;f=c(f);l=this._merge(l,f)}else{l=h}}h=d(l)}else{if(m){var f={};f[m]=h;h=f}}e.setItem(i,JSON.stringify(h));return h},remove:function(i){var h=this._getNamespace(i);i=this._getKey(i);if(i){var g=e.getItem(h);if(g){g=c(JSON.parse(g));if(g[i]){delete g[i]}else{var f=g;a.each(f,function(j){if(j.search(i)!=-1){delete g[j]}})}g=d(g)}this._save(h,g)}else{e.removeItem(h)}return this.get(h)},set:function(h,g){if(typeof(g)=="object"){var f=this.get(h);if(f){g=this._merge(f,g)}}return this._save(h,g)}}}a.sessionStorage=new b(sessionStorage);a.localStorage=new b(localStorage)}(jQuery));
